2022-12-05 00:07:38,698 INFO    : === hps ===
Namespace(data_dir='./data/Causal_Reasoning/', model_dir='bert-base-cased', save_dir='./output/saved_model', log_dir='./output/log', apex_dir='./output/log', output_dir='.', train='train.jsonl', dev='dev.jsonl', test='test.pkl', model_name='bert', save_name=None, data_name='copa', cuda=True, gpu='0', batch_size=64, shuffle=False, epochs=10, evaluation_strategy='step', evaluation_step=467, lr=1e-05, set_seed=True, seed=338, patient=10, loss_func='BCE', hyp_only=False, prompt=None, nowtime='20221205_000738')
2022-12-05 00:07:38,698 INFO    : [DATA] Loading Data
2022-12-05 00:07:38,698 INFO    : [DATA] Hypothesis Only: False
2022-12-05 00:07:38,761 INFO    : [DATA] Tokenization and Padding for Data
2022-12-05 00:07:48,828 INFO    : [INFO] Creating Dataset and splitting batch for data
2022-12-05 00:07:48,828 INFO    : [INFO] Loading pretrained model, setting optimizer and loss function
2022-12-05 00:07:48,829 INFO    : [MODEL] bert
2022-12-05 00:07:50,224 INFO    : === model architecture ===
pretrained_model(
  (model): BertModel(
    (embeddings): BertEmbeddings(
      (word_embeddings): Embedding(28996, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): BertEncoder(
      (layer): ModuleList(
        (0): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (classification): Linear(in_features=768, out_features=1, bias=True)
  (linear): Linear(in_features=3, out_features=1, bias=True)
)
2022-12-05 00:07:51,866 INFO    : [INFO] Start Training
2022-12-05 00:07:51,866 INFO    : [Epoch] 0
2022-12-05 00:13:57,334 INFO    : [Epoch] 1
2022-12-05 00:13:58,161 INFO    : [Dev Evaluation] Strain Evaluation on Dev Set
2022-12-05 00:14:12,128 INFO    : [Dev Metrics] Dev Accuracy: 	0.7420262664165104
2022-12-05 00:14:12,128 INFO    : [Dev Metrics] Dev Loss: 	40.27247554063797
2022-12-05 00:14:12,129 INFO    : [Saving] Saving Model to ./output/saved_model
2022-12-05 00:14:12,864 INFO    : [Patient] 0
2022-12-05 00:20:35,504 INFO    : [Epoch] 2
2022-12-05 00:20:36,327 INFO    : [Dev Evaluation] Strain Evaluation on Dev Set
2022-12-05 00:20:49,973 INFO    : [Dev Metrics] Dev Accuracy: 	0.7612570356472795
2022-12-05 00:20:49,973 INFO    : [Dev Metrics] Dev Loss: 	40.5817429125309
2022-12-05 00:20:49,973 INFO    : [Saving] Saving Model to ./output/saved_model
2022-12-05 00:20:53,019 INFO    : [Patient] 0
2022-12-05 00:26:35,488 INFO    : [Epoch] 3
2022-12-05 00:26:36,217 INFO    : [Dev Evaluation] Strain Evaluation on Dev Set
2022-12-05 00:26:48,474 INFO    : [Dev Metrics] Dev Accuracy: 	0.7504690431519699
2022-12-05 00:26:48,474 INFO    : [Dev Metrics] Dev Loss: 	44.451872169971466
2022-12-05 00:26:48,474 INFO    : [Saving] Saving Model to ./output/saved_model
2022-12-05 00:26:51,504 INFO    : [Patient] 0
2022-12-05 00:32:53,104 INFO    : [Epoch] 4
2022-12-05 00:32:53,833 INFO    : [Dev Evaluation] Strain Evaluation on Dev Set
2022-12-05 00:33:06,090 INFO    : [Dev Metrics] Dev Accuracy: 	0.7457786116322702
2022-12-05 00:33:06,090 INFO    : [Dev Metrics] Dev Loss: 	51.26326221227646
2022-12-05 00:33:06,090 INFO    : [Saving] Saving Model to ./output/saved_model
2022-12-05 00:33:09,125 INFO    : [Patient] 0
2022-12-05 00:39:04,529 INFO    : [Epoch] 5
2022-12-05 00:39:05,358 INFO    : [Dev Evaluation] Strain Evaluation on Dev Set
2022-12-05 00:39:19,284 INFO    : [Dev Metrics] Dev Accuracy: 	0.7382739212007504
2022-12-05 00:39:19,284 INFO    : [Dev Metrics] Dev Loss: 	55.49221575260162
2022-12-05 00:39:19,284 INFO    : [Saving] Saving Model to ./output/saved_model
2022-12-05 00:39:22,335 INFO    : [Patient] 0
2022-12-05 00:45:43,896 INFO    : [Epoch] 6
2022-12-05 00:45:44,720 INFO    : [Dev Evaluation] Strain Evaluation on Dev Set
2022-12-05 00:45:58,602 INFO    : [Dev Metrics] Dev Accuracy: 	0.7218574108818011
2022-12-05 00:45:58,602 INFO    : [Dev Metrics] Dev Loss: 	63.22792863845825
2022-12-05 00:45:58,602 INFO    : [Saving] Saving Model to ./output/saved_model
2022-12-05 00:46:01,634 INFO    : [Patient] 0
2022-12-05 00:52:22,231 INFO    : [Epoch] 7
2022-12-05 00:52:23,044 INFO    : [Dev Evaluation] Strain Evaluation on Dev Set
2022-12-05 00:52:36,835 INFO    : [Dev Metrics] Dev Accuracy: 	0.7181050656660413
2022-12-05 00:52:36,835 INFO    : [Dev Metrics] Dev Loss: 	65.31878781318665
2022-12-05 00:52:36,835 INFO    : [Saving] Saving Model to ./output/saved_model
2022-12-05 00:52:39,872 INFO    : [Patient] 0
2022-12-05 00:59:02,098 INFO    : [Epoch] 8
2022-12-05 00:59:02,913 INFO    : [Dev Evaluation] Strain Evaluation on Dev Set
2022-12-05 00:59:16,678 INFO    : [Dev Metrics] Dev Accuracy: 	0.7185741088180112
2022-12-05 00:59:16,678 INFO    : [Dev Metrics] Dev Loss: 	69.84338915348053
2022-12-05 00:59:16,679 INFO    : [Saving] Saving Model to ./output/saved_model
2022-12-05 00:59:19,713 INFO    : [Patient] 0
2022-12-05 01:05:41,903 INFO    : [Epoch] 9
2022-12-05 01:05:42,737 INFO    : [Dev Evaluation] Strain Evaluation on Dev Set
2022-12-05 01:05:56,811 INFO    : [Dev Metrics] Dev Accuracy: 	0.7138836772983115
2022-12-05 01:05:56,811 INFO    : [Dev Metrics] Dev Loss: 	73.71593111753464
2022-12-05 01:05:56,811 INFO    : [Saving] Saving Model to ./output/saved_model
2022-12-05 01:05:59,872 INFO    : [Patient] 0
